---
phase: 05-arraysbasicsviz
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/Concepts/ArraysBasicsViz.tsx
  - src/components/Concepts/ArraysBasicsViz.module.css
autonomous: true

must_haves:
  truths:
    - "User can step through array reference examples"
    - "Primitives show value copy (independent boxes)"
    - "Arrays show reference copy (arrows to same heap object)"
    - "Mutation through reference affects original array"
  artifacts:
    - path: "src/components/Concepts/ArraysBasicsViz.tsx"
      provides: "Step-through array visualization component"
      exports: ["ArraysBasicsViz"]
      min_lines: 300
    - path: "src/components/Concepts/ArraysBasicsViz.module.css"
      provides: "Component styling with orange accent"
      contains: "--js-viz-accent"
  key_links:
    - from: "ArraysBasicsViz.tsx"
      to: "@/components/SharedViz"
      via: "import"
      pattern: "import.*SharedViz"
    - from: "ArraysBasicsViz.tsx"
      to: "framer-motion"
      via: "import"
      pattern: "import.*framer-motion"
---

<objective>
Rewrite ArraysBasicsViz from tab-based static display to step-through visualization with stack/heap memory model.

Purpose: Enable learners to see how JavaScript handles references vs values, with visual arrows connecting stack variables to heap arrays.

Output: ArraysBasicsViz component with types, beginner examples (value copy, reference copy, mutation), and stack/heap visualization panels.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-arraysbasicsviz/05-CONTEXT.md
@.planning/phases/05-arraysbasicsviz/05-RESEARCH.md
@src/components/Concepts/FunctionsViz.tsx
@src/components/Concepts/MemoryModelViz.tsx
@src/components/SharedViz/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define ArraysBasicsViz types and step interface</name>
  <files>src/components/Concepts/ArraysBasicsViz.tsx</files>
  <action>
Define TypeScript interfaces at the top of the file (replacing existing types):

1. **StackItem** interface:
   - name: string (variable name)
   - value: string (display value like "-> #1" or "42")
   - isReference?: boolean (true for arrays/objects)
   - refId?: string (links to heap object id)
   - highlight?: 'new' | 'changed' | 'none' (for animations)

2. **HeapObject** interface:
   - id: string (unique identifier like "array1")
   - type: 'array' (for this viz, always array)
   - elements: (string | number)[] (array contents)
   - label: string (display label like "#1")
   - highlight?: 'mutated' | 'new' | 'none'

3. **ArrayStep** interface:
   - id: number
   - codeLine: number
   - description: string
   - phase: 'setup' | 'access' | 'reference' | 'mutate' | 'result'
   - stack: StackItem[]
   - heap: HeapObject[]
   - output: string[]

4. **ArrayExample** interface:
   - id: string
   - title: string
   - code: string[]
   - steps: ArrayStep[]
   - insight: string

5. **Level** type: 'beginner' | 'intermediate' | 'advanced'

6. **levelInfo** constant (same pattern as FunctionsViz):
   - beginner: { label: 'Beginner', color: '#10b981' }
   - intermediate: { label: 'Intermediate', color: '#f59e0b' }
   - advanced: { label: 'Advanced', color: '#ef4444' }

Follow the exact type patterns from FunctionsViz.tsx and MemoryModelViz.tsx.
  </action>
  <verify>TypeScript compiles without errors: `npm run build` passes</verify>
  <done>All interfaces defined, Level type exists, levelInfo constant defined</done>
</task>

<task type="auto">
  <name>Task 2: Create beginner examples for reference vs value</name>
  <files>src/components/Concepts/ArraysBasicsViz.tsx</files>
  <action>
Create beginner examples array with 3 examples. Each example demonstrates value vs reference concepts:

**Example 1: "Value vs Reference copy"**
Code:
```javascript
let a = 5
let b = a
b = 10
console.log(a, b)

let arr1 = [1, 2, 3]
let arr2 = arr1
arr2.push(4)
console.log(arr1)
```

Steps:
1. setup: Script starts, empty stack/heap
2. setup: `let a = 5` - primitive stored in stack (no heap)
3. setup: `let b = a` - value COPIED to new stack slot (both show 5)
4. setup: `b = 10` - only b changes (a still 5)
5. reference: `let arr1 = [1,2,3]` - array in heap, arr1 points to it
6. reference: `let arr2 = arr1` - arr2 also points to SAME heap array (new stack item with same refId)
7. mutate: `arr2.push(4)` - heap array mutated, highlight heap object as 'mutated'
8. result: `console.log(arr1)` - shows [1,2,3,4], demonstrate both variables see change

Insight: "Primitives are copied by VALUE (independent). Arrays are copied by REFERENCE (shared)!"

**Example 2: "Mutation through reference"**
Code:
```javascript
let original = [1, 2, 3]
let copy = original

copy[0] = 99

console.log(original[0])
console.log(copy[0])
```

Steps showing how copy[0] = 99 affects original because they point to same heap object.

Insight: "When two variables reference the same array, mutation through either affects both!"

**Example 3: "Multiple references"**
Code showing 3 variables all pointing to same array, demonstrating that mutation through any one is visible to all.

Insight: "Any number of variables can reference the same array. They all see the same data!"

Use the step structure from RESEARCH.md code examples. Make sure refId values match between stack isReference items and heap object ids.
  </action>
  <verify>`npm run build` passes, examples constant exists with 3 beginner examples</verify>
  <done>3 beginner examples with complete step sequences demonstrating value vs reference copy and mutation</done>
</task>

<task type="auto">
  <name>Task 3: Rewrite component with stack/heap visualization</name>
  <files>src/components/Concepts/ArraysBasicsViz.tsx, src/components/Concepts/ArraysBasicsViz.module.css</files>
  <action>
**Replace the entire component** with step-through visualization pattern:

**Component state:**
- useState for level (Level)
- useState for exampleIndex (number)
- useState for stepIndex (number)
- Derived: currentExamples, currentExample, currentStep

**Component structure:**
1. Level selector (3 buttons: beginner/intermediate/advanced)
   - beginner active, intermediate/advanced enabled but empty for now

2. Example tabs (buttons for each example in current level)

3. Main grid layout (2 columns):
   - Left: CodePanel from SharedViz with highlighted line
   - Right: Memory visualization panel containing:
     - Stack section (neon box style from MemoryModelViz)
     - Heap section (neon box style)

4. Stack section:
   - Header: "Stack"
   - AnimatePresence with stack items displayed in reverse order (newest on top)
   - Each item shows: variable name, value
   - Reference items styled differently (show arrow notation like "-> #1")
   - Highlight 'new' items with green glow

5. Heap section:
   - Header: "Heap"
   - AnimatePresence with heap objects
   - Each object shows: label (#1, #2), array elements in brackets
   - Highlight 'mutated' with orange pulse/glow
   - Highlight 'new' with green glow

6. Output panel (console output, like FunctionsViz)

7. StepProgress from SharedViz

8. StepControls from SharedViz

9. Key insight box

**CSS updates (ArraysBasicsViz.module.css):**
- Set --js-viz-accent: #f97316 (orange)
- Copy neon box styles from MemoryModelViz
- Style stack items with reference arrows
- Style heap objects with array element display
- Add highlight animations:
  - .highlight-new: green border/glow fade in
  - .highlight-mutated: orange pulse animation
- Mobile responsive grid (stack on top on small screens)

**Imports required:**
- useState from 'react'
- motion, AnimatePresence from 'framer-motion'
- CodePanel, StepProgress, StepControls from '@/components/SharedViz'
- styles from './ArraysBasicsViz.module.css'

Follow the exact component structure from FunctionsViz.tsx but with stack/heap visualization instead of call stack.
  </action>
  <verify>
- `npm run build` passes
- `npm run dev` and visit /concepts/arrays-basics shows the new visualization
- Can step through beginner examples with Prev/Next/Reset
- Stack shows variables with references pointing to heap
- Heap shows array objects
  </verify>
  <done>Complete ArraysBasicsViz component with step-through visualization, stack/heap panels, SharedViz integration, and orange accent color</done>
</task>

</tasks>

<verification>
Run after all tasks:
- [ ] `npm run build` completes without errors
- [ ] `npm run lint` passes
- [ ] ArraysBasicsViz loads at /concepts/arrays-basics
- [ ] Level selector shows beginner (active), intermediate, advanced
- [ ] 3 beginner examples accessible via tabs
- [ ] Step controls work (Prev/Next/Reset)
- [ ] Stack panel displays variables with arrow notation for references
- [ ] Heap panel displays array objects with elements
- [ ] Mutation steps show orange highlight on heap object
- [ ] Console output appears in output panel
- [ ] Key insight displays at bottom
</verification>

<success_criteria>
1. ArraysBasicsViz completely rewritten from tabs to step-through
2. Stack/heap memory visualization displays correctly
3. Reference arrows connect stack items to heap objects (via matching refId/id)
4. All 3 beginner examples step through smoothly
5. Orange (#f97316) accent color used throughout
6. SharedViz components integrated (CodePanel, StepProgress, StepControls)
</success_criteria>

<output>
After completion, create `.planning/phases/05-arraysbasicsviz/05-01-SUMMARY.md`
</output>
