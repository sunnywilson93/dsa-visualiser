---
phase: 22-foundation-audit
plan: 04
type: execute
wave: 2
depends_on: [22-01, 22-02]
files_modified:
  - e2e/visual-regression.spec.ts-snapshots/
autonomous: true

must_haves:
  truths:
    - "Visual regression baseline snapshots exist for all routes"
    - "Visual regression tests pass with current codebase state"
    - "Baseline is documented as ready for Phase 23 migration comparison"
  artifacts:
    - path: "e2e/visual-regression.spec.ts-snapshots/"
      provides: "Visual regression baseline snapshots"
      min_files: 321
  key_links:
    - from: "e2e/visual-regression.spec.ts"
      to: "e2e/visual-regression.spec.ts-snapshots/"
      via: "Playwright snapshot comparison"
      pattern: "toMatchSnapshot"
---

<objective>
Verify visual regression baseline is current before any migration work begins.

Purpose: Capture or verify the visual baseline before Phase 23+ migration work. This ensures any visual regressions introduced during migration can be detected. Split from Plan 03 since snapshot verification can be time-consuming if issues are found.

Output: Verified or updated visual regression snapshots ready for migration comparison.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-foundation-audit/22-RESEARCH.md
@e2e/visual-regression.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify visual regression baseline is current</name>
  <files>e2e/visual-regression.spec.ts-snapshots/</files>
  <action>
Run visual regression tests to verify baseline snapshots exist and match current state:

1. First, check if snapshots directory exists and count files:
```bash
ls -la e2e/visual-regression.spec.ts-snapshots/ 2>/dev/null | head -5
find e2e -name "*.png" | wc -l
```

2. Run visual regression tests (this will fail if snapshots don't match or are missing):
```bash
npm run test:visual -- --reporter=list 2>&1 | tail -20
```

3. If tests fail due to missing snapshots (not visual differences), update them:
```bash
npm run test:visual:update
```

4. If tests fail due to visual differences, investigate whether the differences are expected (recent code changes) or unexpected (regression). Document findings.

The research indicates 321 snapshots should exist. The visual-regression.spec.ts covers:
- 5 static routes
- 3 pattern routes
- 31 JS concept routes
- 7 DSA concept routes
- 9 category routes
- 19 DSA subcategory routes
- 33 problem concept routes

Total: 107 routes x 3 viewports = 321 expected snapshots.

IMPORTANT: Do not update snapshots if visual differences indicate actual bugs. Report them in the summary.
  </action>
  <verify>
Run: `npm run test:visual -- --reporter=list`
Should pass (exit code 0) with all tests passing. If failures, document in summary.

Verify snapshot count:
```bash
find e2e -name "*.png" | wc -l
```
Should be approximately 321 (107 routes x 3 viewports).
  </verify>
  <done>
Visual regression baseline verified current OR updated with documented reasoning. Baseline captured for Phase 23 migration comparison.
  </done>
</task>

</tasks>

<verification>
1. Run `npm run test:visual` - should pass with baseline matching
2. Snapshot directory exists with expected file count (~321 snapshots)
3. No unexpected visual differences (or differences documented)
</verification>

<success_criteria>
1. Visual regression baseline snapshots exist for all routes (MIG-04)
2. Visual regression tests pass with current codebase state
3. Baseline documented as ready for Phase 23 migration comparison
</success_criteria>

<output>
After completion, create `.planning/phases/22-foundation-audit/22-04-SUMMARY.md`
</output>
