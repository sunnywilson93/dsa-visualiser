---
phase: 22-foundation-audit
plan: 03
type: execute
wave: 2
depends_on: [22-01, 22-02]
files_modified:
  - src/constants/index.ts
autonomous: true

must_haves:
  truths:
    - "Barrel export src/constants/index.ts re-exports all types and constants from child modules"
    - "Visual regression baseline snapshots exist for all routes"
    - "Visual regression tests pass with current codebase state"
  artifacts:
    - path: "src/constants/index.ts"
      provides: "Barrel export for all shared constants"
      exports: ["Level", "LevelConfig", "LEVEL_INFO", "Phase", "getPhaseColor", "PHASE_COLORS", "VariableStatus", "getStatusColor", "STATUS_COLORS"]
  key_links:
    - from: "src/constants/index.ts"
      to: "src/constants/levelInfo.ts"
      via: "re-export"
      pattern: "export .* from './levelInfo'"
    - from: "src/constants/index.ts"
      to: "src/constants/phaseColors.ts"
      via: "re-export"
      pattern: "export .* from './phaseColors'"
    - from: "src/constants/index.ts"
      to: "src/constants/statusColors.ts"
      via: "re-export"
      pattern: "export .* from './statusColors'"
---

<objective>
Create barrel export for constants and verify visual regression baseline is current.

Purpose: Complete the shared infrastructure by enabling clean imports (`import { LEVEL_INFO } from '@/constants'`) and ensure visual baseline is captured before any migration work begins in Phase 23+.

Output: New src/constants/index.ts with all exports, verified visual regression baseline.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-foundation-audit/22-RESEARCH.md
@e2e/visual-regression.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create barrel export for constants</name>
  <files>src/constants/index.ts</files>
  <action>
Create src/constants/index.ts that re-exports all types and constants from child modules:

```typescript
/**
 * Shared constants for visualization components.
 *
 * Usage:
 *   import { LEVEL_INFO, getPhaseColor, getStatusColor } from '@/constants'
 *
 * All color values reference @theme CSS custom properties defined in globals.css.
 */

// Level/difficulty information
export { LEVEL_INFO } from './levelInfo'
export type { Level, LevelConfig } from './levelInfo'

// Execution phase colors
export { PHASE_COLORS, getPhaseColor } from './phaseColors'
export type { Phase } from './phaseColors'

// Variable state colors
export { STATUS_COLORS, STATUS_BG_COLORS, getStatusColor } from './statusColors'
export type { VariableStatus } from './statusColors'
```

This enables:
- `import { LEVEL_INFO } from '@/constants'` - convenient barrel import
- `import { Level } from '@/constants/levelInfo'` - direct module import still works
- Type exports are separate from value exports for tree-shaking
  </action>
  <verify>
Run: `npx tsc --noEmit src/constants/index.ts`
Should complete with no errors. Also verify exports:
`grep "export" src/constants/index.ts | wc -l`
Should return 6 (3 value exports + 3 type exports).
  </verify>
  <done>
index.ts barrel exports all types and constants from levelInfo, phaseColors, and statusColors modules.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify visual regression baseline is current</name>
  <files></files>
  <action>
Run visual regression tests to verify baseline snapshots exist and match current state:

1. First, check if snapshots directory exists and count files:
```bash
ls -la e2e/visual-regression.spec.ts-snapshots/ 2>/dev/null | head -5
find e2e -name "*.png" | wc -l
```

2. Run visual regression tests (this will fail if snapshots don't match or are missing):
```bash
npm run test:visual -- --reporter=list 2>&1 | tail -20
```

3. If tests fail due to missing snapshots (not visual differences), update them:
```bash
npm run test:visual:update
```

4. If tests fail due to visual differences, investigate whether the differences are expected (recent code changes) or unexpected (regression). Document findings.

The research indicates 321 snapshots should exist. The visual-regression.spec.ts covers:
- 5 static routes
- 3 pattern routes
- 31 JS concept routes
- 7 DSA concept routes
- 9 category routes
- 19 DSA subcategory routes
- 33 problem concept routes

Total: 107 routes x 3 viewports = 321 expected snapshots.

IMPORTANT: Do not update snapshots if visual differences indicate actual bugs. Report them in the summary.
  </action>
  <verify>
Run: `npm run test:visual -- --reporter=list`
Should pass (exit code 0) with all tests passing. If failures, document in summary.
  </verify>
  <done>
Visual regression baseline verified current OR updated with documented reasoning. Migration can proceed.
  </done>
</task>

<task type="auto">
  <name>Task 3: Validate complete build passes</name>
  <files></files>
  <action>
Run full build and lint to ensure Phase 22 changes don't break anything:

```bash
npm run lint
npm run build
```

Both commands should complete with zero errors. Document any warnings that appear but don't block the build.

Also verify the constants path alias works:
```bash
# Test that TypeScript resolves @/constants
echo "import { LEVEL_INFO } from '@/constants'" > /tmp/test-import.ts
npx tsc --noEmit --baseUrl . --paths '{"@/*": ["src/*"]}' /tmp/test-import.ts 2>&1 || echo "Import test result above"
rm /tmp/test-import.ts
```
  </action>
  <verify>
`npm run build` exits with code 0.
`npm run lint` exits with code 0 (or only pre-existing warnings).
  </verify>
  <done>
Full build and lint pass. Phase 22 foundation complete and ready for Phase 23 migration.
  </done>
</task>

</tasks>

<verification>
1. Run `npm run build` - should pass with no errors
2. Run `npm run lint` - should pass with no new errors
3. Run `npm run test:visual` - should pass with baseline matching
4. Verify barrel export: `grep "export" src/constants/index.ts` shows all re-exports
5. Verify path alias: TypeScript import from '@/constants' resolves correctly
</verification>

<success_criteria>
1. src/constants/index.ts exists with complete barrel exports
2. Visual regression baseline is verified current (tests pass)
3. Full build passes with zero errors
4. Lint passes with no new warnings
5. All Phase 22 infrastructure ready for migration in Phase 23
</success_criteria>

<output>
After completion, create `.planning/phases/22-foundation-audit/22-03-SUMMARY.md`
</output>
