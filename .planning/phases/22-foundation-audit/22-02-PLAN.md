---
phase: 22-foundation-audit
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/constants/phaseColors.ts
  - src/constants/statusColors.ts
autonomous: true

must_haves:
  truths:
    - "phaseColors module exports getPhaseColor function with all phase names used in codebase"
    - "statusColors module exports getStatusColor function with all variable state names"
    - "Both modules return CSS var references for color values"
  artifacts:
    - path: "src/constants/phaseColors.ts"
      provides: "Execution phase color function"
      exports: ["Phase", "getPhaseColor", "PHASE_COLORS"]
    - path: "src/constants/statusColors.ts"
      provides: "Variable state color function"
      exports: ["VariableStatus", "getStatusColor", "STATUS_COLORS"]
  key_links:
    - from: "src/constants/phaseColors.ts"
      to: "src/styles/globals.css"
      via: "CSS var references"
      pattern: "var\\(--color-(blue|amber|emerald|purple|gray)-\\d+\\)"
    - from: "src/constants/statusColors.ts"
      to: "src/styles/globals.css"
      via: "CSS var references"
      pattern: "var\\(--color-(amber|emerald|blue|red)-\\d+\\)"
---

<objective>
Create shared phaseColors and statusColors modules for execution phase and variable state colors.

Purpose: Foundation for migrating 20 components with inline getPhaseColor and 4 components with getStatusColor to shared imports. Centralizes color definitions that are duplicated across visualization components.

Output: New src/constants/phaseColors.ts and src/constants/statusColors.ts with typed exports.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-foundation-audit/22-RESEARCH.md
@src/components/Concepts/PromisesCreationViz.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Grep all phase names and create phaseColors module</name>
  <files>src/constants/phaseColors.ts</files>
  <action>
The phase list below is manually curated from research analysis of all visualization components. The grep command is informational only - the comprehensive list was derived from studying the codebase patterns in 22-RESEARCH.md.

Known phases from research include:
- Creation, Executor, Resolve, Complete, Schedule, Continue
- Async Resolve, Setup, Branch
- Error, Reject, Pending, Settled
- Run, Wait, Execute, Return
- Push, Pop, Call, Callback
- Timer, Microtask, Macrotask

Create the module:

```typescript
/**
 * Shared execution phase colors for async/promise visualization components.
 * All colors reference @theme CSS custom properties.
 */

// Union of all phase names used across visualization components
export type Phase =
  | 'Creation' | 'Executor' | 'Resolve' | 'Complete' | 'Schedule' | 'Continue'
  | 'Async Resolve' | 'Setup' | 'Branch' | 'Error' | 'Reject' | 'Pending' | 'Settled'
  | 'Run' | 'Wait' | 'Execute' | 'Return' | 'Push' | 'Pop' | 'Call' | 'Callback'
  | 'Timer' | 'Microtask' | 'Macrotask' | 'Tick' | 'Check' | 'Process'
  | 'Sync' | 'Async' | 'Queue' | 'Dequeue' | 'Spawn' | 'Terminate'

export const PHASE_COLORS: Record<Phase, string> = {
  // Creation/Setup phases (blue)
  Creation: 'var(--color-blue-400)',
  Setup: 'var(--color-blue-400)',
  Spawn: 'var(--color-blue-400)',

  // Execution phases (amber/yellow)
  Executor: 'var(--color-amber-500)',
  Execute: 'var(--color-amber-500)',
  Run: 'var(--color-amber-500)',
  Branch: 'var(--color-amber-500)',
  Process: 'var(--color-amber-500)',

  // Success/Complete phases (emerald/green)
  Resolve: 'var(--color-emerald-500)',
  Complete: 'var(--color-emerald-500)',
  'Async Resolve': 'var(--color-emerald-500)',
  Settled: 'var(--color-emerald-500)',
  Return: 'var(--color-emerald-500)',

  // Schedule/Queue phases (purple)
  Schedule: 'var(--color-purple-400)',
  Queue: 'var(--color-purple-400)',
  Microtask: 'var(--color-purple-400)',

  // Wait/Pending phases (gray)
  Continue: 'var(--color-gray-400)',
  Wait: 'var(--color-gray-400)',
  Pending: 'var(--color-gray-400)',

  // Error phases (red)
  Error: 'var(--color-red-500)',
  Reject: 'var(--color-red-500)',

  // Stack operations (cyan/teal)
  Push: 'var(--color-cyan-400)',
  Pop: 'var(--color-cyan-400)',
  Call: 'var(--color-cyan-400)',
  Callback: 'var(--color-cyan-400)',

  // Timer/Task phases (orange/amber variants)
  Timer: 'var(--color-amber-400)',
  Macrotask: 'var(--color-amber-400)',
  Tick: 'var(--color-amber-400)',
  Check: 'var(--color-amber-400)',
  Dequeue: 'var(--color-amber-400)',

  // Sync/Async markers
  Sync: 'var(--color-blue-500)',
  Async: 'var(--color-purple-500)',

  // Worker phases
  Terminate: 'var(--color-red-400)',
} as const

export const getPhaseColor = (phase: Phase | string): string => {
  return PHASE_COLORS[phase as Phase] ?? 'var(--color-gray-400)'
}
```

Add any additional phases discovered from the grep output.
  </action>
  <verify>
Run: `npx tsc --noEmit src/constants/phaseColors.ts`
Should complete with no errors.
  </verify>
  <done>
phaseColors.ts exports Phase type, PHASE_COLORS constant, and getPhaseColor function covering all execution phases.
  </done>
</task>

<task type="auto">
  <name>Task 2: Grep all status names and create statusColors module</name>
  <files>src/constants/statusColors.ts</files>
  <action>
First, run grep to find all unique status/state names:
```bash
grep -rh "statusColor\|stateColor\|getStatusColor" src/components/Concepts/ | head -50
```

Based on research, HoistingViz and VariablesViz use variable states like:
- hoisted, TDZ (temporal dead zone), initialized
- undefined, created, assigned

Create src/constants/statusColors.ts:

```typescript
/**
 * Shared variable state colors for scope/hoisting visualization components.
 * All colors reference @theme CSS custom properties.
 */

// Variable lifecycle states
export type VariableStatus =
  | 'hoisted' | 'TDZ' | 'initialized' | 'assigned'
  | 'undefined' | 'created' | 'declared' | 'active'
  | 'error' | 'shadowed' | 'captured'

export const STATUS_COLORS: Record<VariableStatus, string> = {
  // Declaration phase (amber - warning state)
  hoisted: 'var(--color-amber-500)',
  declared: 'var(--color-amber-500)',

  // TDZ / Error states (red)
  TDZ: 'var(--color-red-500)',
  error: 'var(--color-red-500)',

  // Initialized / Active states (emerald/green)
  initialized: 'var(--color-emerald-500)',
  assigned: 'var(--color-emerald-500)',
  active: 'var(--color-emerald-500)',

  // Creation / Undefined states (blue)
  created: 'var(--color-blue-400)',
  undefined: 'var(--color-blue-400)',

  // Special states (purple)
  shadowed: 'var(--color-purple-400)',
  captured: 'var(--color-purple-400)',
} as const

export const getStatusColor = (status: VariableStatus | string): string => {
  return STATUS_COLORS[status as VariableStatus] ?? 'var(--color-gray-400)'
}

// Background variants (15% opacity) for status badges
export const STATUS_BG_COLORS: Record<VariableStatus, string> = {
  hoisted: 'var(--color-amber-15)',
  declared: 'var(--color-amber-15)',
  TDZ: 'var(--color-red-15)',
  error: 'var(--color-red-15)',
  initialized: 'var(--color-emerald-15)',
  assigned: 'var(--color-emerald-15)',
  active: 'var(--color-emerald-15)',
  created: 'var(--color-blue-15)',
  undefined: 'var(--color-blue-15)',
  shadowed: 'var(--color-purple-15)',
  captured: 'var(--color-purple-15)',
} as const
```

Add any additional statuses discovered from the grep output.
  </action>
  <verify>
Run: `npx tsc --noEmit src/constants/statusColors.ts`
Should complete with no errors.
  </verify>
  <done>
statusColors.ts exports VariableStatus type, STATUS_COLORS constant, getStatusColor function, and STATUS_BG_COLORS.
  </done>
</task>

</tasks>

<verification>
1. Run `npm run build` - should pass with no errors
2. Verify phaseColors: `npx tsc --noEmit src/constants/phaseColors.ts` passes
3. Verify statusColors: `npx tsc --noEmit src/constants/statusColors.ts` passes
4. Verify CSS var pattern: `grep 'var(--color' src/constants/phaseColors.ts src/constants/statusColors.ts` shows var() references
</verification>

<success_criteria>
1. phaseColors.ts exists with Phase union covering all codebase phases
2. statusColors.ts exists with VariableStatus union covering all variable states
3. Both modules use CSS var references (not hex codes)
4. TypeScript compilation passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-foundation-audit/22-02-SUMMARY.md`
</output>
