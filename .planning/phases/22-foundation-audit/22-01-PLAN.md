---
phase: 22-foundation-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/globals.css
  - src/constants/levelInfo.ts
autonomous: true

must_haves:
  truths:
    - "All required opacity variants (15, 20, 30, 40) exist in @theme for emerald, amber, red, blue"
    - "levelInfo module exports LEVEL_INFO with CSS var references for beginner/intermediate/advanced"
    - "LEVEL_INFO includes color, bg (15% opacity), and border (40% opacity) properties"
  artifacts:
    - path: "src/constants/levelInfo.ts"
      provides: "Shared levelInfo constant with CSS var references"
      exports: ["Level", "LevelConfig", "LEVEL_INFO"]
    - path: "src/styles/globals.css"
      provides: "@theme block with all opacity variants"
      contains: "--color-red-40"
  key_links:
    - from: "src/constants/levelInfo.ts"
      to: "src/styles/globals.css"
      via: "CSS var references"
      pattern: "var\\(--color-(emerald|amber|red)-(15|40)\\)"
---

<objective>
Add missing opacity variants to @theme and create shared levelInfo module for difficulty colors.

Purpose: Foundation for migrating 42 components with inline levelInfo definitions to shared import. Opacity variants must exist before CSS var references can work.

Output: Updated globals.css with complete opacity variants, new src/constants/levelInfo.ts with typed exports.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-foundation-audit/22-RESEARCH.md
@src/styles/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add missing opacity variants to @theme</name>
  <files>src/styles/globals.css</files>
  <action>
Add the 3 missing opacity variants to the @theme block in globals.css:

1. Find the @theme block section with color opacity variants (around lines 96-156)
2. Add these 3 missing variants after existing ones in each color's section:
   - `--color-blue-30: rgba(56, 189, 248, 0.3);` (after --color-blue-20)
   - `--color-blue-40: rgba(56, 189, 248, 0.4);` (after --color-blue-30)
   - `--color-red-40: rgba(251, 113, 133, 0.4);` (after --color-red-30)

Summary of missing variants:
- blue: needs 30, 40 (already has 15, 20)
- red: needs 40 (already has 15, 20, 30)
- emerald: complete (has 15, 20, 30, 40)
- amber: complete (has 15, 20, 30, 40)

Preserve alphabetical order within each color section. The rgba values should use the base color values already defined (blue-400 is #38bdf8, red-400 is #fb7185).
  </action>
  <verify>
Run: `grep -E '--color-(emerald|amber|red|blue)-(15|20|30|40):' src/styles/globals.css | wc -l`
Should return 16 (4 colors x 4 variants each).
  </verify>
  <done>
All 4 accent colors (emerald, amber, red, blue) have 15, 20, 30, 40 opacity variants defined in @theme.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create levelInfo module with CSS var references</name>
  <files>src/constants/levelInfo.ts</files>
  <action>
Create the src/constants/ directory if it doesn't exist, then create levelInfo.ts:

```typescript
/**
 * Shared level/difficulty information for visualization components.
 * All colors reference @theme CSS custom properties for consistency.
 */

export type Level = 'beginner' | 'intermediate' | 'advanced'

export interface LevelConfig {
  label: string
  color: string      // Primary text/icon color
  bg: string         // Background (15% opacity)
  border: string     // Border (40% opacity)
  description?: string  // Optional description for tooltips
}

export const LEVEL_INFO: Record<Level, LevelConfig> = {
  beginner: {
    label: 'Beginner',
    color: 'var(--color-emerald-500)',
    bg: 'var(--color-emerald-15)',
    border: 'var(--color-emerald-40)',
  },
  intermediate: {
    label: 'Intermediate',
    color: 'var(--color-amber-500)',
    bg: 'var(--color-amber-15)',
    border: 'var(--color-amber-40)',
  },
  advanced: {
    label: 'Advanced',
    color: 'var(--color-red-500)',
    bg: 'var(--color-red-15)',
    border: 'var(--color-red-40)',
  },
} as const
```

Key points:
- Uses `as const` for compile-time literal types
- Color values are CSS var references, not hex codes
- Optional description field for backward compatibility with components that use it
- bg uses 15% opacity, border uses 40% opacity (matching current inline patterns)
  </action>
  <verify>
Verify the file exists and exports are correct:
`test -f src/constants/levelInfo.ts && grep -E "export (type|interface|const)" src/constants/levelInfo.ts`

Then validate TypeScript (file must exist first):
`test -f src/constants/levelInfo.ts && npx tsc --noEmit src/constants/levelInfo.ts`
  </verify>
  <done>
levelInfo.ts exports Level type, LevelConfig interface, and LEVEL_INFO constant with CSS var references.
  </done>
</task>

</tasks>

<verification>
1. Run `npm run build` - should pass with no errors
2. Verify opacity variants: `grep -E '--color-(emerald|amber|red|blue)-(15|20|30|40):' src/styles/globals.css | wc -l` returns 16
3. Verify levelInfo module: `npx tsc --noEmit src/constants/levelInfo.ts` passes
4. Verify CSS var pattern: `grep 'var(--color' src/constants/levelInfo.ts` shows var() references
</verification>

<success_criteria>
1. All 4 accent colors have complete opacity variant coverage (15, 20, 30, 40)
2. levelInfo.ts exists with proper TypeScript exports
3. LEVEL_INFO uses CSS var references (not hex codes)
4. Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-foundation-audit/22-01-SUMMARY.md`
</output>
