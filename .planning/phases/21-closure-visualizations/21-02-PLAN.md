---
phase: 21-closure-visualizations
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/Concepts/ClosurePracticalViz.tsx
autonomous: true

must_haves:
  truths:
    - "User can step through data privacy pattern seeing private variables inaccessible from outside"
    - "User can step through factory function pattern seeing independent closures created"
    - "User can step through state encapsulation pattern seeing shared private scope"
    - "User can switch between beginner/intermediate/advanced examples"
  artifacts:
    - path: "src/components/Concepts/ClosurePracticalViz.tsx"
      provides: "Practical closure patterns visualization"
      contains: "ClosurePracticalViz"
      min_lines: 250
  key_links:
    - from: "ClosurePracticalViz.tsx"
      to: "ClosuresViz pattern"
      via: "ExecutionContext, HeapObject with PRIVATE scope label"
      pattern: "PRIVATE|scopeRef"
---

<objective>
Create ClosurePracticalViz component showing practical closure use cases: data privacy, factory functions, and state encapsulation.

Purpose: Demonstrate real-world closure applications that learners encounter in production code and interviews. Focus on WHY closures are useful, not just how they work.

Output: Fully functional ClosurePracticalViz.tsx with examples covering data privacy, factories, and state patterns.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-closure-visualizations/21-RESEARCH.md
@src/components/Concepts/ClosuresViz.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ClosurePracticalViz component</name>
  <files>src/components/Concepts/ClosurePracticalViz.tsx</files>
  <action>
Create ClosurePracticalViz.tsx following the ClosuresViz.tsx template:

1. Add 'use client' directive
2. Import React hooks and framer-motion
3. Copy interface definitions from ClosuresViz

4. Create examples for three levels:

BEGINNER:
- "Counter" - createCounter pattern (already in ClosuresViz, enhance it)
  - Show count variable in private scope
  - Show increment modifying private state
  - Highlight that count cannot be accessed directly
- "Simple Factory" - createGreeter(name) returns greeting function
  - name captured in closure, used when greeting

INTERMEDIATE:
- "Data Privacy" - createPerson pattern (from ClosuresViz private-vars)
  - _age variable with underscore convention
  - Multiple methods (getName, getAge, birthday) sharing scope
  - Show "(PRIVATE)" label on scope object
  - Demonstrate that _age cannot be accessed via person._age
- "Event Handler Factory" - createClickHandler(id)
  - Returns function that logs "Clicked item {id}"
  - Show different handlers with different captured ids

ADVANCED:
- "Stateful API" - createAPI(baseUrl)
  - Private state: requestCount, lastResponse
  - Public methods: get(), post(), getStats()
  - Show multiple calls incrementing private counter
- "Memoization" - createMemo(fn)
  - Private cache object
  - Show cache hits vs misses

5. Visual enhancements specific to this component:
   - "(PRIVATE)" label on scope objects containing private variables
   - Lock icon (Lucide React Lock) next to private variables
   - Show "Access Denied" or strikethrough when trying to access private var directly
   - Different color for public vs private (purple for private, green for public)

6. Key step types to show:
   - "Private scope created with {vars}"
   - "Method closes over private scope"
   - "Private state modified through closure"
   - "Direct access blocked - private!"

7. Insight messages:
   - Beginner: "Closures let you create private state that only specific functions can access"
   - Intermediate: "This pattern was JavaScript's way of creating private members before #privateField"
   - Advanced: "Closures enable stateful APIs without exposing internal implementation details"
  </action>
  <verify>
    - File exists: ls -la src/components/Concepts/ClosurePracticalViz.tsx
    - No TypeScript errors: npx tsc --noEmit src/components/Concepts/ClosurePracticalViz.tsx 2>&1 | head -20
    - Has lock import: grep -n "Lock" src/components/Concepts/ClosurePracticalViz.tsx
    - Build passes: npm run build 2>&1 | grep -i error || echo "Build passed"
  </verify>
  <done>
    - ClosurePracticalViz.tsx exists with practical examples
    - "(PRIVATE)" labels on private scope objects
    - Three difficulty levels with progressive complexity
    - Factory pattern and data privacy demonstrated
    - State encapsulation visible in advanced examples
  </done>
</task>

<task type="auto">
  <name>Task 2: Register ClosurePracticalViz in concepts data</name>
  <files>src/data/concepts.ts</files>
  <action>
Add ClosurePracticalViz to the concepts data file:

1. Import ClosurePracticalViz:
   import { ClosurePracticalViz } from '@/components/Concepts/ClosurePracticalViz'

2. Add new concept entry:
   - id: 'closure-practical'
   - title: 'Practical Closures'
   - description: 'Data privacy, factory functions, and state encapsulation patterns'
   - component: ClosurePracticalViz
   - keyPoints: focus on privacy, factories, real-world usage
   - interviewTips: module pattern, private methods, why closures matter
  </action>
  <verify>
    - Concept registered: grep -n "closure-practical\|ClosurePracticalViz" src/data/concepts.ts
    - Import present: grep -n "import.*ClosurePracticalViz" src/data/concepts.ts
    - No syntax errors: npx tsc --noEmit src/data/concepts.ts
  </verify>
  <done>
    - ClosurePracticalViz imported and registered in concepts.ts
    - Concept entry added with id 'closure-practical'
    - Navigable via concept routing
  </done>
</task>

</tasks>

<verification>
1. Component exists and compiles:
   - ls src/components/Concepts/ClosurePracticalViz.tsx
   - npx tsc --noEmit

2. Build passes:
   - npm run build

3. Contains expected patterns:
   - grep -c "PRIVATE" src/components/Concepts/ClosurePracticalViz.tsx (should be > 0)
</verification>

<success_criteria>
- ClosurePracticalViz shows data privacy, factory, and state patterns
- Private scope objects labeled with "(PRIVATE)"
- Three difficulty levels with 2+ examples each
- Component registered in concepts.ts
- Build and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/21-closure-visualizations/21-02-SUMMARY.md`
</output>
