---
phase: 08-twopointerviz
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.tsx
  - src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.module.css
  - src/components/DSAPatterns/index.ts
  - src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate to /concepts/dsa/patterns/two-pointers and see TwoPointersViz"
    - "User can switch between Converging, Same Direction, and Partition variant tabs"
    - "User can switch between beginner, intermediate, and advanced difficulty levels"
    - "User can step through Two Sum II example seeing pointer positions and decision logic"
    - "User can step through Valid Palindrome example seeing pointer positions"
    - "Code panel highlights current line synced with step"
  artifacts:
    - path: "src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.tsx"
      provides: "TwoPointersViz component with types, state, variant tabs, difficulty tabs, 2 beginner examples"
      min_lines: 200
    - path: "src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.module.css"
      provides: "Styling for array cells, pointer indicators, decision panel, tabs"
      min_lines: 100
    - path: "src/components/DSAPatterns/index.ts"
      provides: "Barrel export including TwoPointersViz"
      contains: "TwoPointersViz"
  key_links:
    - from: "src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx"
      to: "TwoPointersViz"
      via: "conditional import for two-pointers pattern"
      pattern: "patternId.*two-pointers.*TwoPointersViz"
    - from: "src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.tsx"
      to: "SharedViz components"
      via: "import and render"
      pattern: "import.*CodePanel.*StepControls.*StepProgress"
---

<objective>
Create the core TwoPointersViz component with variant tabs, difficulty levels, and beginner examples.

Purpose: Establish the component foundation following v1.0 visualization patterns (LoopsViz) with DSA-specific features (variant tabs, decision logic display, pointer animation).

Output: Working TwoPointersViz component rendering on the two-pointers pattern page with 2 beginner examples (Two Sum II, Valid Palindrome).
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-twopointerviz/08-CONTEXT.md
@.planning/phases/08-twopointerviz/08-RESEARCH.md
@.planning/phases/07-foundation/07-01-SUMMARY.md
@.planning/phases/07-foundation/07-02-SUMMARY.md
@src/components/Concepts/LoopsViz.tsx
@src/components/DSAPatterns/types.ts
@src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TwoPointersViz component with types, state, and beginner examples</name>
  <files>
    src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.tsx
    src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.module.css
    src/components/DSAPatterns/index.ts
  </files>
  <action>
Create TwoPointersViz following LoopsViz patterns exactly.

**Types (in component file):**
```typescript
type Level = 'beginner' | 'intermediate' | 'advanced'
type Variant = 'converging' | 'same-direction' | 'partition'
type Phase = 'init' | 'compare' | 'move' | 'done'

interface TwoPointerStep {
  id: number
  codeLine: number
  description: string
  phase: Phase
  pointers: {
    left: number    // or slow for same-direction
    right: number   // or fast for same-direction
  }
  decision?: {
    condition: string      // "Is sum > target?"
    conditionMet: boolean
    action: string         // "Move right pointer left"
  }
  array: (number | string)[]
  highlightedCells?: number[]
  output?: string[]
}

interface TwoPointerExample {
  id: string
  title: string
  variant: Variant
  code: string[]
  steps: TwoPointerStep[]
  insight: string
}
```

**State management:**
- `variant` state for Converging | Same Direction | Partition tabs
- `level` state for beginner/intermediate/advanced
- `exampleIndex` state for example tabs within level
- `stepIndex` state for current step
- Reset stepIndex to 0 on variant, level, or example change

**Component structure:**
1. Variant tabs at top (Converging | Same Direction | Partition)
2. Difficulty buttons below (beginner/intermediate/advanced with colored dots)
3. Example tabs within level
4. Main grid: CodePanel left, Array visualization right
5. Decision logic panel above array (when step.decision exists)
6. Array cells with pointer indicators below
7. StepProgress with description
8. StepControls for navigation
9. Insight box at bottom

**Array visualization:**
- Cells in a row with values
- Pointer labels (L/R or slow/fast) below cells with arrow indicators
- When pointers collide (same index), show combined label "L,R"
- Cell states: active (highlighted), processed (muted), pending (default)

**Decision logic display (per CONTEXT.md):**
- Positioned above array
- Format: "Is sum > target? Yes -> move right pointer left"
- Fade in with framer-motion when decision exists

**Beginner examples (converging variant only):**

1. **Two Sum II** (array: [1, 3, 4, 5, 7, 10, 11], target: 9)
   - Full trace showing: init pointers at 0 and 6, compare sum, decide which pointer to move, repeat until found
   - ~12-15 steps showing the decision logic before each move
   - insight: "Two pointers on sorted array avoids O(n^2) nested loops"

2. **Valid Palindrome** (string: "racecar" as array)
   - Full trace comparing characters from both ends
   - ~10-12 steps
   - insight: "Converging pointers check symmetry in O(n) time"

**CSS Module styling:**
- Dark theme consistent with LoopsViz
- Array cells in a flex row with gap
- Cell states: .active (accent color glow), .processed (dim), .pending (default)
- Pointer labels positioned below cells with small arrow
- Decision panel with question/answer styling
- Variant tabs styled like level buttons but wider
- Smooth transitions on pointer position changes

Update DSAPatterns/index.ts to export TwoPointersViz.
  </action>
  <verify>
    - File exists at src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.tsx
    - File compiles: `npm run build 2>&1 | head -50` shows no TypeScript errors
    - TwoPointersViz exported from index.ts
  </verify>
  <done>
    TwoPointersViz component exists with types, state management, variant tabs, difficulty tabs, and 2 beginner examples (Two Sum II, Valid Palindrome). Component compiles without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire TwoPointersViz to pattern page</name>
  <files>
    src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
  </files>
  <action>
Update PatternPageClient.tsx to render TwoPointersViz when patternId is 'two-pointers'.

Replace the vizPlaceholder section with conditional rendering:
```typescript
import { TwoPointersViz } from '@/components/DSAPatterns'

// In render, replace vizPlaceholder:
{patternId === 'two-pointers' ? (
  <TwoPointersViz />
) : (
  <div className={styles.vizPlaceholder}>
    <p>Step-through visualization coming soon...</p>
  </div>
)}
```

Keep the placeholder for hash-map and bit-manipulation patterns (phases 9-10).
  </action>
  <verify>
    - `npm run build` passes
    - `npm run dev` and visit http://localhost:3000/concepts/dsa/patterns/two-pointers shows TwoPointersViz component
  </verify>
  <done>
    Pattern page at /concepts/dsa/patterns/two-pointers renders TwoPointersViz component. User can see variant tabs, difficulty selector, and step through beginner examples.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `npm run lint` passes
3. Navigate to /concepts/dsa/patterns/two-pointers - TwoPointersViz renders
4. Variant tabs visible: Converging | Same Direction | Partition
5. Difficulty buttons work: beginner/intermediate/advanced
6. Two Sum II and Valid Palindrome examples selectable in beginner level
7. Step through examples - code highlighting syncs, pointer positions update, decision logic displays
</verification>

<success_criteria>
- TwoPointersViz component renders on pattern page
- Variant tabs switch (though only Converging has examples in this plan)
- Difficulty tabs switch (beginner has examples, others empty for now)
- Step controls work: prev/next/reset
- Code panel highlights current line
- Array visualization shows pointer positions
- Decision logic appears before pointer movement
</success_criteria>

<output>
After completion, create `.planning/phases/08-twopointerviz/08-01-SUMMARY.md`
</output>
