---
phase: 10-bitmanipulationviz
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.tsx
  - src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.module.css
  - src/components/DSAPatterns/BitManipulationViz/index.ts
  - src/components/DSAPatterns/index.ts
  - src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can navigate to /concepts/dsa/patterns/bit-manipulation and see BitManipulationViz"
    - "Component displays variant tabs (XOR Tricks, Bit Masks, Shift Operations)"
    - "Component displays difficulty level selector (Beginner, Intermediate, Advanced)"
    - "Binary representation grid shows bit positions with position labels"
    - "Bit width display indicator shows current width (4, 8, 16, or 32)"
  artifacts:
    - path: "src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.tsx"
      provides: "Main component with types, state, binary grid rendering"
      exports: ["BitManipulationViz"]
    - path: "src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.module.css"
      provides: "Styling for binary grid, bit cells, operator display"
      contains: ".bitGrid"
    - path: "src/components/DSAPatterns/BitManipulationViz/index.ts"
      provides: "Component export"
      exports: ["BitManipulationViz"]
    - path: "src/components/DSAPatterns/index.ts"
      provides: "Updated barrel export including BitManipulationViz"
      exports: ["BitManipulationViz"]
  key_links:
    - from: "src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx"
      to: "src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.tsx"
      via: "conditional render for patternId === 'bit-manipulation'"
      pattern: "patternId === 'bit-manipulation'"
    - from: "src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.tsx"
      to: "@/components/SharedViz"
      via: "import and render CodePanel, StepProgress, StepControls"
      pattern: "import.*SharedViz"
---

<objective>
Create the core BitManipulationViz component with types, binary grid display, and wire it to the pattern page.

Purpose: Establish the foundation for bit manipulation visualization following HashMapViz pattern exactly.
Output: Working BitManipulationViz shell with variant/level/example navigation and binary display grid.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-bitmanipulationviz/10-RESEARCH.md
@src/components/DSAPatterns/HashMapViz/HashMapViz.tsx
@src/components/DSAPatterns/HashMapViz/HashMapViz.module.css
@src/components/ConceptPanel/BitManipulationConcept.tsx
@src/data/dsaPatterns.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BitManipulationViz component with types and binary grid</name>
  <files>
    src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.tsx
    src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.module.css
    src/components/DSAPatterns/BitManipulationViz/index.ts
  </files>
  <action>
Create the BitManipulationViz component following HashMapViz structure exactly.

**Types (in component file, not separate):**
```typescript
type Level = 'beginner' | 'intermediate' | 'advanced'
type Variant = 'xor-tricks' | 'bit-masks' | 'shift-operations'
type Phase = 'read-value' | 'show-binary' | 'apply-operation' | 'show-result' | 'done'

interface BitStep {
  id: number
  codeLine: number
  description: string
  phase: Phase
  numbers: BinaryNumber[]
  operator?: '&' | '|' | '^' | '<<' | '>>' | '~'
  result?: number
  activeBits?: number[]
  bitWidth: 4 | 8 | 16 | 32
  decision?: {
    condition: string
    conditionMet: boolean
    action: string
  }
  output?: string[]
}

interface BinaryNumber {
  label: string
  value: number
}

interface BitExample {
  id: string
  title: string
  variant: Variant
  code: string[]
  steps: BitStep[]
  insight: string
}
```

**Component structure:**
- State: variant, level, exampleIndex, stepIndex (exactly like HashMapViz)
- variantInfo object: xor-tricks ("XOR Tricks", "Use XOR properties to find unique elements"), bit-masks ("Bit Masks", "Check, set, or clear specific bits"), shift-operations ("Shift Operations", "Multiply/divide by powers of 2")
- levelInfo object: beginner/intermediate/advanced with colors #10b981/#f59e0b/#ef4444
- examples: Record<Variant, Record<Level, BitExample[]>> - start empty, will populate in 10-02

**Binary grid rendering (adapt from BitManipulationConcept.tsx):**
```typescript
function toBinary(num: number, bits: number): string {
  if (num < 0) {
    return (num >>> 0).toString(2).slice(-bits).padStart(bits, '1')
  }
  return num.toString(2).padStart(bits, '0')
}

function getOperatorSymbol(op: string): string {
  const ops: Record<string, string> = {
    '&': 'AND', '|': 'OR', '^': 'XOR',
    '<<': 'LEFT SHIFT', '>>': 'RIGHT SHIFT', '~': 'NOT'
  }
  return ops[op] || op
}
```

**Render binary row:**
- label (variable name), decimal value, = sign, bit cells
- Each bit cell: motion.div with isOne/isZero styling, isActive for highlight
- Staggered animation: delay = i * 0.05 for result row
- Bit position calculation: `bits - 1 - stringIndex` (CRITICAL: see research pitfalls)

**Bit position labels row:**
- Show position numbers 0-N below bits
- Highlight active positions matching activeBits

**Bit width indicator:**
- Display current bitWidth as read-only badge (author-controlled per example)
- Format: "8-bit" style badge in corner of binary grid

**CSS (BitManipulationViz.module.css):**
- Copy structure from HashMapViz.module.css
- Replace bucket-specific styles with bit-specific:
  - .bitGrid instead of .bucketGrid
  - .bitRow for each binary number display
  - .bit for individual bit cells (use .one/.zero for coloring)
  - .active for highlighted bits (glow effect like HashMapViz .activeBucket)
  - .operatorRow for displaying operator between numbers
  - .divider for line before result
  - .bitPositions for position labels row
  - .bitWidthBadge for displaying current width
- Bit cell sizing: 24px for 4/8 bit, 18px for 16-bit, 14px for 32-bit

**Import SharedViz:** CodePanel, StepProgress, StepControls from '@/components/SharedViz'
  </action>
  <verify>
    - File exists at src/components/DSAPatterns/BitManipulationViz/BitManipulationViz.tsx
    - File compiles without TypeScript errors
    - Component exports BitManipulationViz
    - Has variant/level state management
    - Has binary rendering functions toBinary and getOperatorSymbol
  </verify>
  <done>
    BitManipulationViz component exists with types, state management, binary grid rendering, and styling.
    Empty examples show "coming soon" placeholder for all variant/level combinations.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire BitManipulationViz to pattern page</name>
  <files>
    src/components/DSAPatterns/index.ts
    src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
  </files>
  <action>
**Update DSAPatterns barrel export (index.ts):**
Add BitManipulationViz to exports:
```typescript
export { TwoPointersViz } from './TwoPointersViz/TwoPointersViz'
export { HashMapViz } from './HashMapViz/HashMapViz'
export { BitManipulationViz } from './BitManipulationViz/BitManipulationViz'

export * from './types'
```

**Update PatternPageClient.tsx:**
1. Import BitManipulationViz from '@/components/DSAPatterns'
2. Add conditional render for 'bit-manipulation' pattern:
```typescript
{patternId === 'two-pointers' ? (
  <TwoPointersViz />
) : patternId === 'hash-map' ? (
  <HashMapViz />
) : patternId === 'bit-manipulation' ? (
  <BitManipulationViz />
) : (
  <div className={styles.vizPlaceholder}>
    ...
  </div>
)}
```
  </action>
  <verify>
    - npm run build passes
    - npm run lint passes
    - Navigate to /concepts/dsa/patterns/bit-manipulation shows BitManipulationViz component
    - Variant tabs display (XOR Tricks, Bit Masks, Shift Operations)
    - Level selector displays (Beginner, Intermediate, Advanced)
    - Empty state message shows for all combinations
  </verify>
  <done>
    BitManipulationViz renders at /concepts/dsa/patterns/bit-manipulation.
    Variant tabs and level selector are functional.
    Empty state placeholder shows while waiting for examples.
  </done>
</task>

</tasks>

<verification>
- npm run build passes without errors
- npm run lint passes without errors
- Navigate to http://localhost:3000/concepts/dsa/patterns/bit-manipulation
- BitManipulationViz component renders with:
  - Variant tabs (XOR Tricks, Bit Masks, Shift Operations)
  - Level selector (Beginner, Intermediate, Advanced)
  - Empty state placeholder for examples
- Clicking variant tabs switches active variant
- Clicking level buttons switches active level
</verification>

<success_criteria>
- BitManipulationViz component exists with full type definitions
- Binary rendering functions implemented (toBinary, getOperatorSymbol)
- Component wired to /concepts/dsa/patterns/bit-manipulation route
- Variant and level navigation functional
- CSS styling complete for binary grid (bit cells, positions, operator)
- Build and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/10-bitmanipulationviz/10-01-SUMMARY.md`
</output>
