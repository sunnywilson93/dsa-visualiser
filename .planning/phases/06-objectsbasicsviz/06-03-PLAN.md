---
phase: 06-objectsbasicsviz
plan: 03
type: execute
wave: 3
depends_on: ["06-02"]
files_modified:
  - src/components/Concepts/ObjectsBasicsViz.tsx
  - src/components/Concepts/ObjectsBasicsViz.module.css
autonomous: true

must_haves:
  truths:
    - "User can step through basic destructuring showing properties extracted to stack variables"
    - "User can step through destructuring with renaming syntax"
    - "User can step through destructuring with default values"
    - "Destructuring panel shows extraction visually during destructure phase"
  artifacts:
    - path: "src/components/Concepts/ObjectsBasicsViz.tsx"
      provides: "Advanced examples with destructuring and DestructureState interface"
      contains: "DestructureState"
    - path: "src/components/Concepts/ObjectsBasicsViz.module.css"
      provides: "Destructuring panel styles"
      contains: "destructurePanel"
  key_links:
    - from: "ObjectStep"
      to: "DestructureState"
      via: "destructureState optional field"
      pattern: "destructureState\\?"
---

<objective>
Add advanced examples demonstrating object destructuring with visual extraction animation.

Purpose: Show learners how destructuring extracts object properties into standalone variables, including renaming and default value syntax.
Output: 3 advanced examples with destructuring visualization panel.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-objectsbasicsviz/06-RESEARCH.md
@.planning/phases/06-objectsbasicsviz/06-01-SUMMARY.md
@.planning/phases/06-objectsbasicsviz/06-02-SUMMARY.md
@src/components/Concepts/ArraysBasicsViz.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add DestructureState interface and update ObjectStep</name>
  <files>src/components/Concepts/ObjectsBasicsViz.tsx</files>
  <action>
Add DestructureState interface after existing interfaces:

```typescript
interface DestructureState {
  sourceRefId: string
  extractedProps: {
    propKey: string
    targetVar: string
    value: string
    status: 'pending' | 'extracting' | 'complete'
  }[]
}
```

Ensure ObjectStep interface includes optional destructureState:
```typescript
interface ObjectStep {
  // ... existing fields
  destructureState?: DestructureState
}
```

The destructureState tracks which properties are being extracted:
- sourceRefId: which heap object is being destructured
- extractedProps: array of properties being extracted
  - propKey: the property name in the object
  - targetVar: the variable name (same as propKey unless renaming)
  - value: the extracted value as string
  - status: animation state (pending -> extracting -> complete)
  </action>
  <verify>TypeScript compiles with new interface</verify>
  <done>DestructureState interface defined and integrated into ObjectStep</done>
</task>

<task type="auto">
  <name>Task 2: Add basic destructuring example</name>
  <files>src/components/Concepts/ObjectsBasicsViz.tsx</files>
  <action>
Add to advanced array:

Example: "Basic destructuring"
```javascript
const person = { name: 'Alice', age: 25 }
const { name, age } = person

console.log(name)
console.log(age)
```

Steps:
1. Setup: Script starts
2. Create person object #1 with name: 'Alice', age: 25
3. Begin destructuring - show destructureState with:
   - sourceRefId: 'person1'
   - extractedProps: [{propKey: 'name', targetVar: 'name', value: '"Alice"', status: 'extracting'}, {propKey: 'age', targetVar: 'age', value: '25', status: 'pending'}]
   - Highlight name property in heap object
4. Continue destructuring - age now extracting, name complete:
   - extractedProps: [{...name, status: 'complete'}, {...age, status: 'extracting'}]
5. Destructuring complete - show new stack variables name and age with highlight: 'new'
   - Stack: [person -> #1, name: '"Alice"' (new), age: '25' (new)]
   - No destructureState (complete)
6. console.log(name) outputs "Alice"
7. console.log(age) outputs "25"

Insight: "Destructuring extracts properties into standalone variables. They hold copies of the primitive values!"

Use phase: 'destructure' for extraction steps.
  </action>
  <verify>Example compiles, destructureState populated correctly</verify>
  <done>Basic destructuring example with step-by-step extraction</done>
</task>

<task type="auto">
  <name>Task 3: Add destructuring with renaming example</name>
  <files>src/components/Concepts/ObjectsBasicsViz.tsx</files>
  <action>
Add to advanced array:

Example: "Destructuring with renaming"
```javascript
const user = { name: 'Alice', id: 42 }
const { name: userName, id: oderId } = user

console.log(userName)
console.log(userId)
```

Steps:
1. Setup: Script starts
2. Create user object #1 with name: 'Alice', id: 42
3. Begin destructuring with renaming:
   - extractedProps: [
       {propKey: 'name', targetVar: 'userName', value: '"Alice"', status: 'extracting'},
       {propKey: 'id', targetVar: 'userId', value: '42', status: 'pending'}
     ]
   - Description emphasizes: "name: userName means 'take name, call it userName'"
4. Continue extraction, id -> userId
5. Complete - stack shows userName and userId (NOT name and id)
6. console.log(userName) outputs "Alice"
7. console.log(userId) outputs "42"

Insight: "{ name: userName } extracts the 'name' property but stores it in a variable called 'userName'."
  </action>
  <verify>Example shows propKey different from targetVar in destructureState</verify>
  <done>Renaming destructuring example showing key -> variable name mapping</done>
</task>

<task type="auto">
  <name>Task 4: Add destructuring with default values example</name>
  <files>src/components/Concepts/ObjectsBasicsViz.tsx</files>
  <action>
Add to advanced array:

Example: "Destructuring with defaults"
```javascript
const config = { theme: 'dark' }
const { theme, language = 'en' } = config

console.log(theme)
console.log(language)
```

Steps:
1. Setup: Script starts
2. Create config object #1 with only theme: 'dark' (no language property)
3. Begin destructuring:
   - extractedProps: [
       {propKey: 'theme', targetVar: 'theme', value: '"dark"', status: 'extracting'},
       {propKey: 'language', targetVar: 'language', value: '"en" (default)', status: 'pending'}
     ]
   - Description: "theme exists, will use its value"
4. Extract language with default:
   - Status: 'extracting' for language
   - Description: "language doesn't exist in object, using default value 'en'"
5. Complete - stack shows theme: '"dark"' and language: '"en"' with note about default
6. console.log(theme) outputs "dark"
7. console.log(language) outputs "en"

Insight: "Default values (= 'en') are used only when the property is missing or undefined."
  </action>
  <verify>Example shows default value being applied for missing property</verify>
  <done>Default values example showing fallback for missing properties</done>
</task>

<task type="auto">
  <name>Task 5: Add destructuring panel UI and CSS</name>
  <files>src/components/Concepts/ObjectsBasicsViz.tsx, src/components/Concepts/ObjectsBasicsViz.module.css</files>
  <action>
In ObjectsBasicsViz.tsx, add destructuring panel rendering after the mainGrid:

```tsx
{currentStep.destructureState && (
  <div className={styles.destructurePanel}>
    <div className={styles.destructureHeader}>
      <span className={styles.destructureBadge}>Destructuring</span>
      <span className={styles.sourceRef}>
        from {currentStep.stack.find(s => s.refId === currentStep.destructureState?.sourceRefId)?.name || 'object'}
      </span>
    </div>

    <div className={styles.extractionList}>
      {currentStep.destructureState.extractedProps.map((prop, idx) => (
        <motion.div
          key={prop.propKey}
          className={`${styles.extractionItem} ${styles[prop.status]}`}
          initial={{ opacity: 0, x: 20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ delay: idx * 0.1 }}
        >
          <span className={styles.extractSource}>{prop.propKey}</span>
          <span className={styles.extractArrow}>
            {prop.status === 'extracting' ? '→→→' : '→'}
          </span>
          <span className={styles.extractTarget}>{prop.targetVar}</span>
          <span className={styles.extractValue}>= {prop.value}</span>
          {prop.status === 'complete' && (
            <span className={styles.extractCheck}>✓</span>
          )}
        </motion.div>
      ))}
    </div>
  </div>
)}
```

In ObjectsBasicsViz.module.css, add destructure panel styles:

```css
.destructurePanel {
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(20, 184, 166, 0.5);
  border-radius: var(--radius-xl);
  overflow: hidden;
}

.destructureHeader {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  padding: var(--space-sm) var(--space-md);
  background: rgba(20, 184, 166, 0.12);
  border-bottom: 1px solid rgba(20, 184, 166, 0.3);
}

.destructureBadge {
  font-family: 'Fira Code', monospace;
  font-size: var(--text-sm);
  font-weight: var(--font-bold);
  color: #fff;
  background: var(--js-viz-accent);
  padding: 0.25rem 0.6rem;
  border-radius: var(--radius-md);
}

.sourceRef {
  font-family: 'Fira Code', monospace;
  font-size: var(--text-sm);
  color: var(--gray-400);
}

.extractionList {
  padding: var(--space-md);
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
}

.extractionItem {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  padding: var(--space-sm) var(--space-md);
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid var(--js-viz-border);
  border-radius: var(--radius-md);
  font-family: 'Fira Code', monospace;
  font-size: var(--text-sm);
}

.extractionItem.pending {
  opacity: 0.5;
}

.extractionItem.extracting {
  border-color: var(--js-viz-accent);
  background: rgba(20, 184, 166, 0.1);
  animation: extractPulse 0.8s ease-in-out infinite;
}

.extractionItem.complete {
  border-color: rgba(16, 185, 129, 0.5);
  background: rgba(16, 185, 129, 0.08);
}

@keyframes extractPulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(20, 184, 166, 0.4);
  }
  50% {
    box-shadow: 0 0 12px 2px rgba(20, 184, 166, 0.3);
  }
}

.extractSource {
  color: var(--gray-400);
  min-width: 80px;
}

.extractArrow {
  color: var(--js-viz-accent);
  font-weight: var(--font-bold);
}

.extractTarget {
  color: var(--gray-300);
  font-weight: var(--font-semibold);
  min-width: 80px;
}

.extractValue {
  color: #10b981;
}

.extractCheck {
  color: #10b981;
  font-weight: var(--font-bold);
  margin-left: auto;
}
```
  </action>
  <verify>Destructure panel appears during destructure phase, shows extraction progress</verify>
  <done>Destructuring panel renders with status indicators and animations</done>
</task>

</tasks>

<verification>
1. Run `npm run build` - no errors
2. Navigate to /concepts/objects-basics
3. Select "Advanced" level
4. Test "Basic destructuring":
   - Step through extraction animation
   - See destructure panel with status: pending -> extracting -> complete
   - Verify new stack variables appear
   - Console outputs correct values
5. Test "Destructuring with renaming":
   - See propKey differs from targetVar in panel
   - Confirm userName/userId appear in stack (not name/id)
6. Test "Destructuring with defaults":
   - See "(default)" marker on language value
   - Confirm default 'en' appears in stack and output
7. Verify destructure panel disappears after extraction complete
</verification>

<success_criteria>
- DestructureState interface integrated into ObjectStep
- 3 advanced examples with complete destructuring step data
- Destructuring panel shows extraction progress with status indicators
- Renaming syntax clearly shows key -> variable mapping
- Default values marked distinctly when property missing
- Animations provide visual feedback during extraction
</success_criteria>

<output>
After completion, create `.planning/phases/06-objectsbasicsviz/06-03-SUMMARY.md`
</output>
