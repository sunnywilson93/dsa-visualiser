---
phase: 04-functionsviz
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/components/Concepts/FunctionsViz.tsx
  - src/components/Concepts/FunctionsViz.module.css
autonomous: true

must_haves:
  truths:
    - "User can see arguments flowing into parameter slots with animation"
    - "Missing arguments show as undefined in parameter visualization"
    - "Extra arguments are shown as ignored"
    - "Default parameters show fallback when argument missing/undefined"
  artifacts:
    - path: "src/components/Concepts/FunctionsViz.tsx"
      provides: "Parameter binding animation and intermediate examples"
      contains: "ParameterBinding"
    - path: "src/components/Concepts/FunctionsViz.module.css"
      provides: "Parameter binding animation styles"
      contains: "paramBinding"
  key_links:
    - from: "FunctionsViz.tsx"
      to: "currentStep.parameterBindings"
      via: "render"
      pattern: "parameterBindings.*map"
---

<objective>
Add parameter binding visualization with animated argument-to-parameter flow

Purpose: Help learners visualize how arguments flow into function parameters, including edge cases like missing arguments and default parameters
Output: Intermediate examples with parameter binding animation showing argument -> parameter mapping
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-functionsviz/04-01-SUMMARY.md
@src/components/Concepts/FunctionsViz.tsx
@src/components/Concepts/FunctionsViz.module.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add ParameterBinding type and intermediate examples</name>
  <files>src/components/Concepts/FunctionsViz.tsx</files>
  <action>
Add ParameterBinding interface to track argument -> parameter flow:

```typescript
interface ParameterBinding {
  argumentIndex: number
  argumentValue: string
  argumentLabel: string  // "arg 1", "arg 2", etc.
  parameterName: string
  boundValue: string     // actual value bound (may differ from argumentValue for defaults)
  status: 'waiting' | 'flowing' | 'bound'
  isDefault: boolean     // true if using default value
  isExtra: boolean       // true if extra argument (no corresponding param)
  isMissing: boolean     // true if param has no argument (undefined)
}
```

Update FunctionStep interface to include optional parameterBindings:
```typescript
interface FunctionStep {
  // ... existing fields
  parameterBindings?: ParameterBinding[]
}
```

Create 4 intermediate examples:

**Example 1: "Basic parameter binding"**
- Function: `function greet(name, greeting) { return greeting + ', ' + name }`
- Call: `greet('Alice', 'Hello')`
- Steps show:
  1. Function defined
  2. Call initiated, arguments ready: ['Alice', 'Hello']
  3. Parameter binding: 'Alice' -> name (animate flow)
  4. Parameter binding: 'Hello' -> greeting (animate flow)
  5. Both bound, context active
  6. Execute body
  7. Return value
  8. Context destroyed

**Example 2: "Missing arguments (undefined)"**
- Function: `function add(a, b) { return a + b }`
- Call: `add(5)` // only one argument
- Steps show:
  1. Function defined
  2. Call with 1 argument
  3. Binding: 5 -> a (normal flow)
  4. Binding: (missing) -> b = undefined (show warning style)
  5. Execute: 5 + undefined = NaN
  6. Return NaN

**Example 3: "Extra arguments (ignored)"**
- Function: `function first(a) { return a }`
- Call: `first(1, 2, 3)` // extra arguments
- Steps show:
  1. Function defined
  2. Call with 3 arguments
  3. Binding: 1 -> a (normal)
  4. Arguments 2 and 3 shown as "ignored" (grayed out style)
  5. Execute
  6. Return 1

**Example 4: "Default parameters"**
- Function: `function greet(name, greeting = 'Hello') { return greeting + ', ' + name }`
- Call: `greet('Bob')` // greeting uses default
- Steps show:
  1. Function defined (show default in signature)
  2. Call with 1 argument
  3. Binding: 'Bob' -> name (normal)
  4. Binding: (missing) -> greeting = 'Hello' (default) - show default value being used
  5. Execute
  6. Return "Hello, Bob"

Each step during binding phase should have parameterBindings array with status field indicating animation state.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit` passes</verify>
  <done>ParameterBinding interface added. 4 intermediate examples created demonstrating basic binding, missing args, extra args, and default parameters.</done>
</task>

<task type="auto">
  <name>Task 2: Implement parameter binding visualization component</name>
  <files>src/components/Concepts/FunctionsViz.tsx, src/components/Concepts/FunctionsViz.module.css</files>
  <action>
Add parameter binding visualization panel that shows when `currentStep.parameterBindings` exists:

**Component structure:**
```tsx
{currentStep.parameterBindings && (
  <div className={styles.paramBindingPanel}>
    <div className={styles.panelHeader}>Parameter Binding</div>
    <div className={styles.bindingFlow}>
      {/* Arguments column */}
      <div className={styles.argumentsColumn}>
        <div className={styles.columnLabel}>Arguments</div>
        {currentStep.parameterBindings
          .filter(b => !b.isMissing)
          .map((binding, i) => (
            <motion.div
              key={binding.argumentIndex}
              className={`${styles.argument} ${binding.isExtra ? styles.extraArg : ''}`}
              initial={{ opacity: 0, x: -10 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: i * 0.1 }}
            >
              <span className={styles.argLabel}>{binding.argumentLabel}</span>
              <span className={styles.argValue}>{binding.argumentValue}</span>
            </motion.div>
          ))}
      </div>

      {/* Flow arrows */}
      <div className={styles.flowArrows}>
        {currentStep.parameterBindings
          .filter(b => !b.isExtra)
          .map((binding, i) => (
            <motion.div
              key={i}
              className={`${styles.flowArrow} ${binding.status === 'flowing' ? styles.flowing : ''} ${binding.status === 'bound' ? styles.bound : ''}`}
              initial={{ scaleX: 0 }}
              animate={{ scaleX: binding.status !== 'waiting' ? 1 : 0 }}
              transition={{ delay: i * 0.15, duration: 0.3 }}
            >
              â†’
            </motion.div>
          ))}
      </div>

      {/* Parameters column */}
      <div className={styles.parametersColumn}>
        <div className={styles.columnLabel}>Parameters</div>
        {currentStep.parameterBindings
          .filter(b => !b.isExtra)
          .map((binding, i) => (
            <motion.div
              key={binding.parameterName}
              className={`${styles.parameter} ${binding.isMissing ? styles.missingArg : ''} ${binding.isDefault ? styles.defaultArg : ''} ${binding.status === 'bound' ? styles.boundParam : ''}`}
              initial={{ opacity: 0.5 }}
              animate={{ opacity: binding.status === 'bound' ? 1 : 0.5 }}
              transition={{ delay: i * 0.15 + 0.3 }}
            >
              <span className={styles.paramName}>{binding.parameterName}</span>
              <span className={styles.paramValue}>
                {binding.status === 'bound' ? binding.boundValue : '?'}
                {binding.isDefault && <span className={styles.defaultBadge}>(default)</span>}
                {binding.isMissing && !binding.isDefault && <span className={styles.undefinedBadge}>undefined</span>}
              </span>
            </motion.div>
          ))}
      </div>
    </div>

    {/* Extra arguments notice */}
    {currentStep.parameterBindings.some(b => b.isExtra) && (
      <div className={styles.extraArgsNotice}>
        Extra arguments ignored
      </div>
    )}
  </div>
)}
```

**CSS styling for parameter binding:**
```css
.paramBindingPanel {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(139, 92, 246, 0.2);
  border-radius: var(--radius-xl);
  padding: var(--space-lg);
}

.bindingFlow {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: var(--space-lg);
}

.argumentsColumn, .parametersColumn {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
  min-width: 120px;
}

.flowArrows {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
  padding-top: 24px; /* align with values */
}

.flowArrow {
  font-size: 1.5rem;
  color: var(--gray-500);
  transform-origin: left center;
}

.flowArrow.flowing {
  color: #8b5cf6;
  animation: pulse 0.5s ease-in-out;
}

.flowArrow.bound {
  color: #10b981;
}

.argument, .parameter {
  padding: var(--space-sm);
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--radius-md);
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.extraArg {
  opacity: 0.5;
  text-decoration: line-through;
}

.missingArg {
  border: 1px dashed #ef4444;
}

.defaultArg {
  border: 1px solid #f59e0b;
}

.boundParam {
  background: rgba(16, 185, 129, 0.1);
  border: 1px solid rgba(16, 185, 129, 0.3);
}

.defaultBadge {
  font-size: var(--text-2xs);
  color: #f59e0b;
  margin-left: 4px;
}

.undefinedBadge {
  font-size: var(--text-2xs);
  color: #ef4444;
  margin-left: 4px;
}

.extraArgsNotice {
  margin-top: var(--space-md);
  padding: var(--space-sm);
  background: rgba(239, 68, 68, 0.1);
  border-radius: var(--radius-sm);
  font-size: var(--text-sm);
  color: #ef4444;
  text-align: center;
}
```
  </action>
  <verify>
1. `npm run build` passes
2. Visit `/concepts/functions`, select Intermediate level
3. Example 1 (Basic binding): Arguments flow into parameters with animation
4. Example 2 (Missing args): Second parameter shows undefined styling
5. Example 3 (Extra args): Extra arguments shown as ignored/strikethrough
6. Example 4 (Default params): Default value shown when arg missing
  </verify>
  <done>
Parameter binding visualization implemented with:
- Arguments column showing call arguments
- Flow arrows animating argument -> parameter mapping
- Parameters column showing bound values
- Visual indicators for missing (undefined), extra (ignored), and default parameters
- Staggered animation timing for natural flow effect
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles
2. Build passes
3. Intermediate level enabled with 4 examples
4. Parameter binding panel appears during binding steps
5. Argument -> parameter flow animates smoothly
6. Missing argument shows undefined styling
7. Extra arguments shown as ignored
8. Default parameters show fallback value with badge
</verification>

<success_criteria>
- Parameter binding visualization clearly shows argument -> parameter mapping
- Animation flows from left (arguments) to right (parameters)
- Missing arguments result in undefined with visual warning
- Extra arguments shown as ignored with strikethrough
- Default parameters show "(default)" badge when used
- Intermediate examples demonstrate all parameter binding scenarios
</success_criteria>

<output>
After completion, create `.planning/phases/04-functionsviz/04-02-SUMMARY.md`
</output>
