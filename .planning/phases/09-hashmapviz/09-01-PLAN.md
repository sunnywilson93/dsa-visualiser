---
phase: 09-hashmapviz
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/DSAPatterns/HashMapViz/HashMapViz.tsx
  - src/components/DSAPatterns/HashMapViz/HashMapViz.module.css
  - src/components/DSAPatterns/HashMapViz/index.ts
  - src/components/DSAPatterns/index.ts
  - src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate to /concepts/dsa/patterns/hash-map and see HashMapViz component"
    - "User can switch between beginner, intermediate, and advanced difficulty levels"
    - "Key-value pairs display within bucket structure showing hash relationship"
    - "Bucket visualization shows hash function converting key to bucket index"
    - "Lookup and insert operations step through with hash -> bucket -> entry flow"
  artifacts:
    - path: "src/components/DSAPatterns/HashMapViz/HashMapViz.tsx"
      provides: "Main visualization component with types, state, bucket grid, hash calculation"
      min_lines: 200
    - path: "src/components/DSAPatterns/HashMapViz/HashMapViz.module.css"
      provides: "Bucket grid layout, entry styling, hash calculation display styling"
      contains: "bucketGrid"
    - path: "src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx"
      provides: "Dynamic import for hash-map pattern"
      contains: "HashMapViz"
  key_links:
    - from: "src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx"
      to: "src/components/DSAPatterns/HashMapViz"
      via: "dynamic import on pattern.id === 'hash-map'"
      pattern: "hash-map.*HashMapViz"
    - from: "src/components/DSAPatterns/HashMapViz/HashMapViz.tsx"
      to: "src/components/SharedViz"
      via: "import for CodePanel, StepProgress, StepControls"
      pattern: "import.*SharedViz"
---

<objective>
Create the HashMapViz component with bucket grid visualization, hash function display, and beginner examples.

Purpose: Establishes the core hash map visualization enabling learners to see how keys hash to buckets with step-by-step animations.

Output:
- HashMapViz.tsx with types, state management, variant/level tabs, bucket grid, hash calculation display
- HashMapViz.module.css with bucket grid layout and entry animations
- Wiring to pattern page for /concepts/dsa/patterns/hash-map route
- Two beginner examples: Two Sum (complement lookup) and basic frequency counter
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-hashmapviz/09-CONTEXT.md
@.planning/phases/09-hashmapviz/09-RESEARCH.md
@src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.tsx
@src/components/DSAPatterns/TwoPointersViz/TwoPointersViz.module.css
@src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
@src/data/dsaPatterns.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create HashMapViz component with types and bucket grid</name>
  <files>
    src/components/DSAPatterns/HashMapViz/HashMapViz.tsx
    src/components/DSAPatterns/HashMapViz/HashMapViz.module.css
    src/components/DSAPatterns/HashMapViz/index.ts
    src/components/DSAPatterns/index.ts
  </files>
  <action>
Create HashMapViz following TwoPointersViz pattern exactly:

**Types (in component file):**
```typescript
type Level = 'beginner' | 'intermediate' | 'advanced'
type Variant = 'complement-lookup' | 'frequency-counter' | 'index-storage'
type Phase = 'read-key' | 'calculate-hash' | 'access-bucket' | 'return-value' | 'done'

interface HashMapStep {
  id: number
  codeLine: number
  description: string
  phase: Phase
  currentKey?: string | number
  currentValue?: number | string
  hashCalculation?: {
    key: string
    charCodes: number[]
    sum: number
    bucketCount: number
    result: number
  }
  buckets: Bucket[]
  highlightedBucket?: number
  highlightedEntry?: string | number
  decision?: {
    condition: string
    conditionMet: boolean
    action: string
  }
  input?: (number | string)[]
  currentInputIndex?: number
  output?: string[]
}

interface Bucket {
  index: number
  entries: BucketEntry[]
}

interface BucketEntry {
  key: string | number
  value: number | string
  originalIndex?: number
  isNew?: boolean
  isHighlighted?: boolean
}

interface HashMapExample {
  id: string
  title: string
  variant: Variant
  code: string[]
  steps: HashMapStep[]
  insight: string
}
```

**State (match TwoPointersViz):**
- variant, setVariant (default 'complement-lookup')
- level, setLevel (default 'beginner')
- exampleIndex, setExampleIndex (default 0)
- stepIndex, setStepIndex (default 0)
- Reset stepIndex to 0 on variant/level/example change

**Layout:**
- Variant tabs (3 variants from dsaPatterns.ts)
- Level selector (beginner/intermediate/advanced with color dots)
- Example tabs (when multiple examples at same level)
- Main grid: CodePanel (left) | VizPanel (right)
- VizPanel contains: Decision panel, Hash calculation display, Bucket grid, Input array, Output box
- StepProgress and StepControls at bottom
- Insight box below controls

**Bucket Grid (8 buckets per CONTEXT.md):**
- CSS Grid with 8 columns (or 2 rows of 4)
- Each bucket shows index and entries
- Empty buckets show subtle "empty" indicator
- Active bucket glows (similar to TwoPointersViz cell.active)
- Entry animation on insert (scale from 0.8, opacity from 0)
- Value animation on update (scale pulse, color flash for frequency counter)

**Hash Calculation Display:**
- Appears during calculate-hash phase
- Shows: "key" -> char codes (if <=5 chars) -> sum % bucketCount -> bucket[N]
- Animated appearance with framer-motion
- Educational formula: sum of char codes % 8

**Input Array Display:**
- Shows input array being processed
- Highlights current element being processed
- Processed elements dimmed

**Beginner Examples (embed in component):**

1. **Two Sum** (complement-lookup variant):
   - Input: [2, 7, 11, 15], target = 9
   - Steps show: iterate through array, for each num check if complement (target - num) exists, store num -> index
   - 12-15 steps total
   - Show hash calculation for each lookup/insert

2. **Basic Frequency Counter** (frequency-counter variant):
   - Input: [1, 2, 2, 3, 3, 3]
   - Steps show: iterate, check if key exists, increment or set to 1
   - Value update animation with color flash
   - 10-12 steps total

**CSS (match TwoPointersViz patterns):**
- Same variable scheme (--js-viz-bg, --js-viz-border, --js-viz-accent)
- bucketGrid: CSS Grid for 8 buckets
- bucket: individual bucket container with index label
- bucketEntries: container for entries in bucket
- entry: key-value pair with animation
- emptyBucket: subtle "empty" indicator
- activeBucket: glow effect
- hashCalculation: inline display with arrows
- hashKey, hashArrow, hashFormula, hashResult: styled elements
- inputArray, inputCell, activeInput, processedInput
- All mobile responsive (single column on small screens)
  </action>
  <verify>
Run `npm run build` - no TypeScript errors
Run `npm run lint` - no lint errors
Visual inspection: Component file has types, state, layout structure, bucket grid, beginner examples
  </verify>
  <done>
HashMapViz component created with:
- All type definitions (HashMapStep, Bucket, BucketEntry, HashMapExample)
- State management matching TwoPointersViz
- Bucket grid rendering with 8 buckets
- Hash calculation display component
- Input array display
- 2 beginner examples (Two Sum, basic frequency counter)
- CSS module with bucket grid layout and animations
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire HashMapViz to pattern page</name>
  <files>
    src/app/concepts/dsa/patterns/[patternId]/PatternPageClient.tsx
  </files>
  <action>
Add HashMapViz to the pattern page dynamic import pattern (match TwoPointersViz):

1. Add dynamic import:
```typescript
const HashMapViz = dynamic(
  () => import('@/components/DSAPatterns/HashMapViz').then(mod => mod.HashMapViz),
  { ssr: false }
)
```

2. Add case to renderVisualization function:
```typescript
case 'hash-map':
  return <HashMapViz />
```

Ensure the import and case are consistent with how TwoPointersViz is handled.
  </action>
  <verify>
Start dev server: `npm run dev`
Navigate to http://localhost:3000/concepts/dsa/patterns/hash-map
- Page loads without errors
- HashMapViz component renders
- Variant tabs show (Complement Lookup, Frequency Counter, Index Storage)
- Level selector shows (Beginner selected by default)
- Bucket grid displays 8 buckets
- Step through Two Sum example - hash calculations appear
- Switch to frequency-counter variant, step through - value updates animate
  </verify>
  <done>
HashMapViz accessible at /concepts/dsa/patterns/hash-map with:
- Component renders without errors
- All three variant tabs functional
- Beginner examples step through correctly
- Hash calculation displays during appropriate phase
- Bucket highlights on access
- Entry animations on insert/update
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **Route works:** Navigate to /concepts/dsa/patterns/hash-map - component loads
2. **Variant tabs:** Click through all 3 variants - UI updates (only complement-lookup and frequency-counter have examples initially)
3. **Level tabs:** Click beginner - shows examples
4. **Step through Two Sum:**
   - Initial state shows input array and empty buckets
   - Hash calculation appears inline during calculate-hash phase
   - Bucket highlights when accessed
   - Entry appears in bucket with animation
   - Decision panel shows "Is complement in map?" logic
   - Output shows result
5. **Step through Frequency Counter:**
   - Value increments with animation
   - Entry glow on update
   - Final counts shown
6. **Build passes:** `npm run build` completes without errors
</verification>

<success_criteria>
- HashMapViz component exists with full type definitions
- Bucket grid displays 8 buckets with indices
- Hash calculation shows step-by-step formula
- 2 beginner examples implemented and functional
- Component renders at /concepts/dsa/patterns/hash-map
- Build and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/09-hashmapviz/09-01-SUMMARY.md`
</output>
