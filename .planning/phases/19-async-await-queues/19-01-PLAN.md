---
phase: 19-async-await-queues
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/Concepts/PromisesStaticViz.tsx
  - src/components/Concepts/index.ts
  - src/app/concepts/[conceptId]/ConceptPageClient.tsx
autonomous: true

must_haves:
  truths:
    - "User can see Promise.all/race/allSettled/any behaviors compared side-by-side"
    - "User can step through settlement order to see which method settles first"
    - "User can see AggregateError when all promises reject with Promise.any"
    - "User can switch between beginner/intermediate/advanced difficulty levels"
  artifacts:
    - path: "src/components/Concepts/PromisesStaticViz.tsx"
      provides: "Promise static methods comparison visualization"
      min_lines: 300
      exports: ["PromisesStaticViz"]
  key_links:
    - from: "src/app/concepts/[conceptId]/ConceptPageClient.tsx"
      to: "PromisesStaticViz"
      via: "dynamic import"
      pattern: "promises-static-methods.*PromisesStaticViz"
---

<objective>
Create PromisesStaticViz component comparing Promise.all, Promise.race, Promise.allSettled, and Promise.any with animated settlement timelines.

Purpose: Users understand when to use each Promise static method by seeing how they behave differently with the same input promises.
Output: PromisesStaticViz.tsx with 3 difficulty levels and animated timeline showing settlement order.
</objective>

<execution_context>
@/Users/sunnywilson/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunnywilson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-async-await-queues/19-CONTEXT.md
@.planning/phases/19-async-await-queues/19-RESEARCH.md
@src/components/Concepts/PromisesViz.tsx
@src/components/Concepts/EventLoopViz.tsx
@src/components/SharedViz/index.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PromisesStaticViz component</name>
  <files>src/components/Concepts/PromisesStaticViz.tsx</files>
  <action>
Create PromisesStaticViz.tsx following the established patterns:

1. Structure:
   - 'use client' directive at top
   - Import useState, motion/AnimatePresence, Lucide icons
   - Import SharedViz components (CodePanel, StepProgress, StepControls)
   - Define Step interface with: description, highlightLines, inputPromises[], results object (all/race/allSettled/any), output[], phase
   - Define Example interface with: id, title, code[], steps[], insight
   - Define Level type and levelInfo object (beginner/intermediate/advanced)

2. Step data structure per research:
   ```typescript
   interface PromiseItem {
     id: string
     label: string
     state: 'pending' | 'fulfilled' | 'rejected'
     settleOrder?: number
     value?: string
     reason?: string
   }

   interface Step {
     description: string
     highlightLines: number[]
     inputPromises: PromiseItem[]
     results: {
       all: { state: 'pending' | 'fulfilled' | 'rejected'; value?: string; reason?: string }
       race: { state: 'pending' | 'fulfilled' | 'rejected'; value?: string; reason?: string }
       allSettled: { state: 'pending' | 'fulfilled'; value?: { status: string; value?: string; reason?: string }[] }
       any: { state: 'pending' | 'fulfilled' | 'rejected'; value?: string; aggregateError?: string[] }
     }
     output: string[]
     phase: string
   }
   ```

3. Examples by level:
   - Beginner: Basic Promise.all/race/allSettled with all-fulfill scenario, Promise.race first-settles-wins
   - Intermediate: Mixed fulfill/reject showing different behaviors, Promise.any ignoring rejections
   - Advanced: All-reject scenario showing AggregateError, edge cases (empty arrays)

4. Visual layout:
   - Four-column grid showing all/race/allSettled/any results side-by-side
   - Settlement timeline with animated order indicators (1st, 2nd, 3rd)
   - Promise cards showing state (pending=gray, fulfilled=green, rejected=red)
   - Use PromisesViz.module.css patterns for promise state colors

5. Key insights to demonstrate:
   - Promise.all: Rejects immediately on first rejection, resolves when ALL fulfill
   - Promise.race: Settles on FIRST settlement (fulfill OR reject)
   - Promise.allSettled: Always fulfills with status array, never rejects
   - Promise.any: Ignores rejections, fulfills on first fulfill, AggregateError if all reject

6. Animations:
   - Promise state transitions with scale/opacity
   - Settlement order numbers appearing with delay
   - Result cards highlighting when method settles

Use SharedViz components for code panel and controls. Match existing neon box styling.
  </action>
  <verify>npm run build passes with no TypeScript errors</verify>
  <done>PromisesStaticViz.tsx exists with 3 levels, 4-method comparison, animated settlement timeline</done>
</task>

<task type="auto">
  <name>Task 2: Wire PromisesStaticViz to routing</name>
  <files>src/components/Concepts/index.ts, src/app/concepts/[conceptId]/ConceptPageClient.tsx</files>
  <action>
1. In src/components/Concepts/index.ts:
   - Add export: `export { PromisesStaticViz } from './PromisesStaticViz'`

2. In src/app/concepts/[conceptId]/ConceptPageClient.tsx:
   - Update the 'promises-static-methods' mapping (currently points to PromisesViz) to:
     `'promises-static-methods': dynamic(() => import('@/components/Concepts/PromisesStaticViz').then(m => m.PromisesStaticViz))`
  </action>
  <verify>npm run dev, navigate to /concepts/promises-static-methods, component renders without errors</verify>
  <done>promises-static-methods route renders PromisesStaticViz component</done>
</task>

</tasks>

<verification>
1. `npm run build` passes
2. `npm run lint` produces no new warnings
3. Navigate to /concepts/promises-static-methods - component loads
4. Step through all examples at all 3 difficulty levels
5. Verify 4-method comparison layout is visible
6. Verify settlement order animations work
</verification>

<success_criteria>
- PromisesStaticViz.tsx exists with Promise.all/race/allSettled/any comparison
- 3 difficulty levels with appropriate examples
- Settlement timeline shows which method settles first
- AggregateError displayed for Promise.any all-reject case
- Mobile responsive layout
- Wired to /concepts/promises-static-methods route
</success_criteria>

<output>
After completion, create `.planning/phases/19-async-await-queues/19-01-SUMMARY.md`
</output>
